```{r}
library(tidyverse)
rm(list = ls())#Clears environment variables
```

Reads in the .csv file which has already been added to the project folder
```{r}
ONP_Original <- read.csv(file = 'OnlineNewsPopularity.csv')
```

Removed Unnecessary Columns
```{r}
ONP_Trimmed <- ONP_Original%>%select(-2:-3,-5:-9,-12:-13,-20:-28,-40:-44)
```

Grouping days of the week into one column for use in lm model. The unite function introduced underscores and zeroes so they were removed using gsub. 
```{r}
ONP_Test <- ONP_Trimmed

ONP_Test$weekday_is_monday <- ONP_Test$weekday_is_monday%>%replace(ONP_Test$weekday_is_monday==1, "Monday")

ONP_Test$weekday_is_tuesday <- ONP_Test$weekday_is_tuesday%>%replace(ONP_Test$weekday_is_tuesday==1, "Tuesday")

ONP_Test$weekday_is_wednesday <- ONP_Test$weekday_is_wednesday%>%replace(ONP_Test$weekday_is_wednesday==1, "Wednesday")

ONP_Test$weekday_is_thursday <- ONP_Test$weekday_is_thursday%>%replace(ONP_Test$weekday_is_thursday==1, "Thursday")

ONP_Test$weekday_is_friday <- ONP_Test$weekday_is_friday%>%replace(ONP_Test$weekday_is_friday==1, "Friday")

ONP_Test$weekday_is_saturday <- ONP_Test$weekday_is_saturday%>%replace(ONP_Test$weekday_is_saturday==1, "Saturday")

ONP_Test$weekday_is_sunday <- ONP_Test$weekday_is_sunday%>%replace(ONP_Test$weekday_is_sunday==1, "Sunday")

ONP_Test <- ONP_Test%>%unite(weekday_is_monday:weekday_is_sunday, col = "day of week", remove = T, sep ="_" )

ONP_Test$`day of week` <- gsub("_", "",ONP_Test$`day of week`)
ONP_Test$`day of week` <- gsub("0", "", ONP_Test$`day of week`)
```

Grouping data channels into one column for use in lm model. The unite function introduced underscores and zeroes so they were removed using gsub.
```{r}
ONP_Test$data_channel_is_lifestyle <- ONP_Test$data_channel_is_lifestyle%>%replace(ONP_Test$data_channel_is_lifestyle==1, "Lifestyle")

ONP_Test$data_channel_is_entertainment <- ONP_Test$data_channel_is_entertainment%>%replace(ONP_Test$data_channel_is_entertainment==1, "Entertainment")

ONP_Test$data_channel_is_bus <- ONP_Test$data_channel_is_bus%>%replace(ONP_Test$data_channel_is_bus==1, "Business")

ONP_Test$data_channel_is_socmed <- ONP_Test$data_channel_is_socmed%>%replace(ONP_Test$data_channel_is_socmed==1, "Social Media")

ONP_Test$data_channel_is_tech <- ONP_Test$data_channel_is_tech%>%replace(ONP_Test$data_channel_is_tech==1, "Technology")

ONP_Test$data_channel_is_world <- ONP_Test$data_channel_is_world%>%replace(ONP_Test$data_channel_is_world==1, "World")

ONP_Test <- ONP_Test%>%unite(data_channel_is_lifestyle:data_channel_is_world, col = "Article_Channel", remove = T, sep ="_" )

ONP_Test$Article_Channel <- gsub("_", "",ONP_Test$Article_Channel)
ONP_Test$Article_Channel <- gsub("0", "", ONP_Test$Article_Channel)
```

```{r}
ONP_Business <- ONP_Trimmed%>%subset(data_channel_is_bus == 1)
```

created histogram to show avg number of shares
```{r}
hist(ONP_Trimmed$self_reference_avg_sharess)
```

histogram to visualize number of words in the articles 
```{r}
hist(ONP_Trimmed$n_tokens_content)
```
```{r}
sapply(ONP_Trimmed, function(x) sum(is.na(x)))
```

```{r}
ONP.lm = lm(formula=shares ~ num_videos + num_imgs + n_tokens_content + rate_positive_words+rate_negative_words, data = ONP_Trimmed)
summary(ONP.lm)
```
```{r}
# ONP.glm = glm(formula=shares ~ num_videos + num_imgs + n_tokens_content + rate_positive_words+rate_negative_words, data = ONP_Trimmed)
# summary(ONP.glm)
# pred_ONP <- predict(ONP.lm, type="response")
# pred_ONP
```


```{r}
ggplot(ONP_Trimmed,aes(num_videos,shares) ) + geom_col(size = 5, alpha = 0.5, color="red")
```
```{r}
ggplot(ONP_Trimmed, aes(num_imgs,shares)) + geom_col(size = 3, colour = "blue",  )
```

lm model with all the variables to see effect on shares
```{r}
set.seed(111)
trainList <- createDataPartition(y=ONP_Trimmed$shares, p=.80,list=F)
trainSet <- ONP_Trimmed[trainList,]
testSet <- ONP_Trimmed[-trainList,]
fit1 <- lm(shares ~., trainSet)

#don't run, still need to tweak. 
```


```{r}
ggplot(ONP_Test) + geom_col(aes(x=Article_Channel,y=self_reference_avg_sharess))
```


```{r}
ggplot(ONP_Test) + geom_col(aes(x=(Day_of_Week),y=shares), color='blue')
```
```{r}
ONP_Test <- rename(ONP_Test, 'Day_of_Week' ='day of week')
```

There seem to be rows in the Article Channel with black cells, speak with Kellen about possibly removing those rows.  
```{r}
sum(ONP_Test$Article_Channel=="")#counts blanks in Article channel
ONP_Final <- ONP_Test[-which(ONP_Test$Article_Channel == ""), ]#removes rows with blanks
sum(ONP_Test$`day of week`=="")#all rows in Day of Week appear to be populated 


```

